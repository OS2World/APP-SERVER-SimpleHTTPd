<html><head>
<title>SimpleHTTPd - Module MOD_stat</title>
</head><body background="/gif/paper.gif" fixed>

<img src="/stat?config">

<table noborder width="100%">
<tr><td align=center>
<img src="/gif/tools2.gif" width=40 height=40 alt="Installation">
</td><td valign=center><font size=+2>
Configuration of the Module <tt>MOD_stat</tt>
</font></td></tr>
</table>

<a name="configuration"></a>
<a name="MOD_stat"></a>

<p>
The purpose of this module is simple statistics. When the module receives a
request, it creates an empty, transparent 1*1 pixel GIF image. Any information
given by the query string of the request is used in order to update the
internal statistics. The data specified in the query string is taken as a
(case-sensitive) name. The module stores the <i>hits</i> to these names in
a hit list within the WWW server's directory, in an ASCII file. To keep the
file small, only a top list of names is kept.
</p>

<p>
A reference to the statistic is done by placing an image link on the HTML
page, on which access should be counted. A reference with the name
<tt><u>hit_me</u></tt> could be done by adding this line to the HTML page:
<pre>
        &lt;IMG SRC=&quot;/stat?<i>hit_me</i>&quot;&gt;
</pre>
</p>

<p>
The statistic can be queried via <a href="/admin">administration section</a>,
by showing the module's configuration. Every time, the server shuts down or
re-configures, the information is written to a file <tt>mod_stat.lst</tt> in
the WWW server's executable directory. (<i>The information is not written each
time access takes place in order to keep the system load and I/O activities at
a low level.</i>)
</p>

<p>
The contents of the file could show something like this:<pre>
# Information is stored like this:
# <no. of hits> <last access time> <name>
#  |             |                  |
#  |             +--- time stamp    +--- reference
#  |                  as hex-decimal     name
#  |                  seconds since
#  +--- number of     1970/01/01 0:00
#       hits
       2 0x35C8584D index
       1 0x35C85724 install
      42 0x35C85CB6 config
      11 0x35C85A1A a-z
       1 0x35C85856 copyrght
</pre>
The first entry contains the number of hits of the entry, referenced by the
name, standing at last (third position). The time stamp, the second data in a
line, is a hexadecimal 32 bit number, which represents the seconds since 1970,
January 1st, midnight. Normally, you can take this info, store it in a C
variable of type <tt>time_t</tt> and do <tt>gmtime()</tt>, <tt>ctime()</tt>,
etc. on it.
</p>

<p>
Since the module is very easy constructed, source code is included in all
distributions of shttpd. You can find it in the file
<a href="/samples/mod_stat.c"><tt>src/samples/mod_stat.c</tt></a>.
</p>

<! --- reference to previous and next chapter ------------------------------- >
<a href="../config.htm#admin_modules"><img align=right border=0
src="/gif/up.gif" width=20 height=20 alt="^"></a>
<br clear=all>

<! --- footer --------------------------------------------------------------- >
<hr><table noborder width="100%">
<tr><td><table>
<tr><td align=left valign=top><! --- Table of Contents -------------- >
<table><tr><td align=center valign=top>
<a href="../index.htm"><img src="/gif/book.gif" width=40 height=40
alt="Table of Contents"></a></td></tr><tr><td align=center><font size=-3>
Table of<br>Contents
</font></td></tr></table>
</td><td align=left valign=top><! --- Index ------------------------- >
<table><tr><td align=center valign=top>
<a href="../a-z.htm"><img src="/gif/a-z.gif" width=40 height=40
alt="Index"></a>
</td></tr><tr><td align=center><font size=-3>
Index A-Z
</font></td></tr></table>
</td><td align=left valign=top><! --- Server Administration --------- >
<table><tr><td align=center valign=top>
<a href="/admin"><img src="/gif/tools.gif" width=40 height=40
alt="Server Administration"></a></td></tr><tr><td align=center><font size=-3>
Server Ad-<br>ministration
</font></td></tr></table>
</td><td align=left valign=top><! --- Copyright --------------------- >
<table><tr><td align=center valign=top>
<a href="../copyrght.htm"><img src="/gif/sign.gif" width=40 height=40
alt="Copyright"></a></td></tr><tr><td align=center><font size=-3>
Copyright<br>Notes
</font></td></tr></table>
</table>
<td align=right valign=top><! --- Copyright Info -------------------- >
<font size=-2>&copy. 1998-2000 by Dirk Ohme</font>
</td></tr>
</table>
<! --- footer --------------------------------------------------------------- >

</body></html>
